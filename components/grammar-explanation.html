<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ–‡æ³•èª¬æ˜ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ</title>
    <style>
        /* æ–‡æ³•èª¬æ˜ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .grammar-explanation {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 24px;
            margin: 20px 0;
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        .grammar-content {
            line-height: 1.6;
            color: #333;
        }

        .grammar-content h3 {
            color: #007AFF;
            margin-bottom: 16px;
            font-size: 1.5em;
            font-weight: 600;
        }

        .grammar-content p {
            margin-bottom: 12px;
        }

        .grammar-content code {
            background: #f8f9fa;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace;
            color: #e83e8c;
        }

        .grammar-content ul {
            margin: 12px 0;
            padding-left: 20px;
        }

        .grammar-content li {
            margin-bottom: 8px;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .error {
            background: #fff5f5;
            border: 1px solid #fed7d7;
            border-radius: 8px;
            padding: 16px;
            color: #c53030;
            text-align: center;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #e5e5ea;
        }

        .nav-button {
            background: #007AFF;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.2s;
        }

        .nav-button:hover {
            background: #0056CC;
        }

        .nav-button:disabled {
            background: #c7c7cc;
            cursor: not-allowed;
        }

        .grammar-index {
            margin-top: 20px;
            padding: 16px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .grammar-index h4 {
            margin-bottom: 12px;
            color: #333;
        }

        .grammar-links {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .grammar-link {
            background: #007AFF;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            text-decoration: none;
            font-size: 12px;
            transition: background-color 0.2s;
        }

        .grammar-link:hover {
            background: #0056CC;
        }
    </style>
</head>
<body>
    <div class="grammar-explanation">
        <div id="grammar-content" class="grammar-content">
            <div class="loading">èª­ã¿è¾¼ã¿ä¸­...</div>
        </div>
        
        <div class="navigation">
            <button class="nav-button" id="prev-button" onclick="showPreviousGrammar()">å‰ã¸</button>
            <button class="nav-button" id="next-button" onclick="showNextGrammar()">æ¬¡ã¸</button>
        </div>
        
        <div class="grammar-index">
            <h4>ğŸ“š æ–‡æ³•é …ç›®ä¸€è¦§</h4>
            <div class="grammar-links" id="grammar-links">
                <!-- æ–‡æ³•é …ç›®ã®ãƒªãƒ³ã‚¯ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ -->
            </div>
        </div>
    </div>

    <script>
        let grammarData = {};
        let currentGrammarIndex = 0;
        let grammarKeys = [];

        // grammar.jsonã‚’èª­ã¿è¾¼ã‚€
        async function loadGrammarData() {
            try {
                const response = await fetch('../grammar.json');
                if (!response.ok) {
                    throw new Error('grammar.jsonã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ');
                }
                grammarData = await response.json();
                grammarKeys = Object.keys(grammarData);
                showGrammarIndex();
                showGrammarByKey('pattern_1'); // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ç¬¬1æ–‡å‹ã‚’è¡¨ç¤º
            } catch (error) {
                console.error('grammar.jsonã®èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼:', error);
                document.getElementById('grammar-content').innerHTML = `
                    <div class="error">
                        <h3>ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ</h3>
                        <p>${error.message}</p>
                    </div>
                `;
            }
        }

        // æ–‡æ³•é …ç›®ã‚’è¡¨ç¤º
        function showGrammarByKey(key) {
            if (!grammarData[key]) {
                document.getElementById('grammar-content').innerHTML = `
                    <div class="error">
                        <h3>æ–‡æ³•é …ç›®ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“</h3>
                        <p>ã‚­ãƒ¼: ${key}</p>
                    </div>
                `;
                return;
            }

            currentGrammarIndex = grammarKeys.indexOf(key);
            const content = grammarData[key];
            
            // HTMLã‚¿ã‚°ã‚’é©åˆ‡ã«ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
            const formattedContent = content
                .replace(/<code>/g, '<code>')
                .replace(/<\/code>/g, '</code>')
                .replace(/\n/g, '<br>');

            document.getElementById('grammar-content').innerHTML = `
                <h3>${getGrammarTitle(key)}</h3>
                <div>${formattedContent}</div>
            `;

            updateNavigation();
        }

        // æ–‡æ³•é …ç›®ã®ã‚¿ã‚¤ãƒˆãƒ«ã‚’å–å¾—
        function getGrammarTitle(key) {
            const titles = {
                'pattern_1': 'ç¬¬1æ–‡å‹ï¼ˆS+Vï¼‰',
                'pattern_2': 'ç¬¬2æ–‡å‹ï¼ˆS+V+Cï¼‰',
                'pattern_3': 'ç¬¬3æ–‡å‹ï¼ˆS+V+Oï¼‰',
                'pattern_4': 'ç¬¬4æ–‡å‹ï¼ˆS+V+O+Oï¼‰',
                'pattern_5': 'ç¬¬5æ–‡å‹ï¼ˆS+V+O+Cï¼‰',
                'passive_pattern3': 'ç¬¬3æ–‡å‹ã®å—å‹•æ…‹',
                'passive_pattern4': 'ç¬¬4æ–‡å‹ã®å—å‹•æ…‹',
                'passive_pattern5': 'ç¬¬5æ–‡å‹ã®å—å‹•æ…‹'
            };
            return titles[key] || key;
        }

        // å‰ã®æ–‡æ³•é …ç›®ã‚’è¡¨ç¤º
        function showPreviousGrammar() {
            if (currentGrammarIndex > 0) {
                currentGrammarIndex--;
                showGrammarByKey(grammarKeys[currentGrammarIndex]);
            }
        }

        // æ¬¡ã®æ–‡æ³•é …ç›®ã‚’è¡¨ç¤º
        function showNextGrammar() {
            if (currentGrammarIndex < grammarKeys.length - 1) {
                currentGrammarIndex++;
                showGrammarByKey(grammarKeys[currentGrammarIndex]);
            }
        }

        // ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ã‚’æ›´æ–°
        function updateNavigation() {
            const prevButton = document.getElementById('prev-button');
            const nextButton = document.getElementById('next-button');
            
            prevButton.disabled = currentGrammarIndex === 0;
            nextButton.disabled = currentGrammarIndex === grammarKeys.length - 1;
        }

        // æ–‡æ³•é …ç›®ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’è¡¨ç¤º
        function showGrammarIndex() {
            const linksContainer = document.getElementById('grammar-links');
            const patternKeys = grammarKeys.filter(key => key.startsWith('pattern_') || key.startsWith('passive_'));
            
            linksContainer.innerHTML = patternKeys.map(key => 
                `<a href="#" class="grammar-link" onclick="showGrammarByKey('${key}')">${getGrammarTitle(key)}</a>`
            ).join('');
        }

        // å¤–éƒ¨ã‹ã‚‰å‘¼ã³å‡ºã›ã‚‹é–¢æ•°
        window.showGrammarExplanation = function(key) {
            showGrammarByKey(key);
        };

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€
        document.addEventListener('DOMContentLoaded', loadGrammarData);
    </script>
</body>
</html> 